(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{84296:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/on-demand/payment/received",function(){return t(87251)}])},54978:function(n,e,t){"use strict";t.d(e,{b:function(){return i}});var r=t(85893),a=(t(67294),t(48847)),o=t(9783),i=function(n){var e=n.className,t=n.content,i=n.contentBeforeIcon,c=n.footer,s=n.icon,u=n.title,l=n.titleAfterIcon,f=function(){return(0,r.jsx)("div",{className:"my-3",children:t})};return(0,r.jsxs)("div",{className:(0,a.WM)("flex flex-col justify-center items-center text-center",e),children:[!l&&(0,r.jsx)(o.X,{children:u}),i&&(0,r.jsx)(f,{}),s&&(0,r.jsx)("div",{className:l||i?"mb-10":"mt-10",children:s}),l&&(0,r.jsx)(o.X,{children:u}),!i&&(0,r.jsx)(f,{}),c&&c]})}},61783:function(n,e,t){"use strict";t.d(e,{N:function(){return i},O:function(){return c}});var r=t(85893),a=t(67294),o=t(34929),i=(0,a.createContext)(null),c=function(n){var e=n.children,t=(0,a.useState)(""),c=t[0],s=t[1],u=(0,a.useState)(null),l=u[0],f=u[1],d=(0,a.useState)(null),p=d[0],m=d[1],v=(0,a.useCallback)((function(n){try{var e=new o.SyncClient(n);window.syncClient=e,s(n),f(e)}catch(t){throw new Error(t)}}),[]);return(0,a.useEffect)((function(){l&&l.stream("OnDemandStream").then((function(n){m(n)}))}),[l]),(0,r.jsx)(i.Provider,{value:{syncToken:c,connect:v,syncClient:l,onDemandStream:p},children:e})}},36255:function(n,e,t){"use strict";t.d(e,{Z:function(){return o}});var r=t(67294),a=t(61783);function o(){var n=(0,r.useContext)(a.N);if(!n)throw new Error("useSyncContext must be used within SyncProvider");return n}},30708:function(n,e,t){"use strict";var r=t(85893);e.Z=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(n){var t=n.children;return e.reduceRight((function(n,e){return(0,r.jsx)(e,{children:n})}),t)}}},31237:function(n,e,t){"use strict";var r=t(85893);e.Z=function(){return(0,r.jsx)("div",{className:"flex justify-center m-8",children:(0,r.jsx)("div",{className:"border-t-transparent w-20 h-20 border-4 border-primary border-dotted rounded-full animate-spin"})})}},82340:function(n,e,t){"use strict";var r=t(85893),a=(t(67294),t(61783)),o=(0,t(30708).Z)(a.O);e.Z=function(n){return(0,r.jsx)(o,{children:n.children})}},87251:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return C}});var r=t(34051),a=t.n(r),o=t(85893),i=t(67294),c=t(54978),s=t(23074),u=t(31199),l=t(11163),f=t(36255),d=t(82340),p=t(1107),m=t(51502),v=t(1438),h=t(31237),y=t(43820);function x(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function w(n,e,t,r,a,o,i){try{var c=n[o](i),s=c.value}catch(u){return void t(u)}c.done?e(s):Promise.resolve(s).then(r,a)}function g(n){return function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(n){w(o,r,a,i,c,"next",n)}function c(n){w(o,r,a,i,c,"throw",n)}i(void 0)}))}}function b(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,a,o=[],i=!0,c=!1;try{for(t=t.call(n);!(i=(r=t.next()).done)&&(o.push(r.value),!e||o.length!==e);i=!0);}catch(s){c=!0,a=s}finally{try{i||null==t.return||t.return()}finally{if(c)throw a}}return o}}(n,e)||function(n,e){if(!n)return;if("string"===typeof n)return x(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var j=function(){var n=g(a().mark((function n(e){var t,r,o,i,c,s,u,l;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.t0=b,n.next=4,Promise.all([m.Z.getFromStorage(v.Y8),m.Z.getFromStorage(v.l4)]);case 4:return n.t1=n.sent,t=(0,n.t0)(n.t1,2),r=t[0],o=t[1],i=S(r,o),n.t2=b,n.next=12,Promise.all([p.Z.fetchProviderOnCall(e),p.Z.addPatient(e,i)]);case 12:return n.t3=n.sent,c=(0,n.t2)(n.t3,2),s=c[0],u=c[1],l=N(s,u,o),n.abrupt("return",{appointment:l,patient:i});case 20:n.prev=20,n.t4=n.catch(0),console.error(n.t4);case 23:case"end":return n.stop()}}),n,null,[[0,20]])})));return function(e){return n.apply(this,arguments)}}(),k=function(){var n=g(a().mark((function n(){var e,t,r=arguments;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:"p1000000",t=r.length>1&&void 0!==r[1]?r[1]:"a1000000",n.abrupt("return",fetch(y.X.get(y.X.visits.token),{method:"POST",body:JSON.stringify({role:"patient",action:"PATIENT",id:e,visitId:t}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).catch((function(n){return console.log(n)})));case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),S=function(n,e){var t={};"Yes"===n.needTranslator&&(t={needTranslator:n.needTranslator,language:n.language});return Object.assign({name:n.lastName,family_name:n.lastName,given_name:n.firstName,phone:n.phoneNumber,gender:n.gender,conditions:new Array(e.conditions),medications:new Array(e.medications)},t)},N=function(n,e,t){return{provider_id:n.id,patient_id:e.id,reason:t.reason,references:[]}};function P(n,e,t,r,a,o,i){try{var c=n[o](i),s=c.value}catch(u){return void t(u)}c.done?e(s):Promise.resolve(s).then(r,a)}function T(n){return function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(n){P(o,r,a,i,c,"next",n)}function c(n){P(o,r,a,i,c,"throw",n)}i(void 0)}))}}var _=function(){var n=(0,l.useRouter)(),e=(0,i.useState)(null),t=e[0],r=e[1],d=(0,i.useState)(!1),y=d[0],x=(d[1],(0,f.Z)()),w=x.syncClient,g=x.syncToken,b=x.onDemandStream;function S(){return N.apply(this,arguments)}function N(){return(N=T(a().mark((function n(){var e;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.Z.getFromStorage(v.k0);case 2:return(e=n.sent)&&r(e.passcode),n.abrupt("return",e);case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var P=function(){var e=T(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:(r=e.sent)&&r.passcode?n.push("/patient?token=".concat(r.passcode)):n.push("/patient?token=".concat(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){var e=function(){var e=T(a().mark((function e(){var t,o,i,c,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return t=e.sent,e.next=5,k();case 5:if(o=e.sent,console.log("storageToken=",t,"tempToken=",o,"syncToken =",g,"syncClient =",w,"onDemandStream=",b),!(o&&g&&w&&b)||t){e.next=17;break}return e.next=10,j(o.token);case 10:i=e.sent,console.log("patientAppointment",i),c=i.appointment,s=i.patient,b.publishMessage({appointment:c,patient:s,patientSyncToken:g}).then(function(){var n=T(a().mark((function n(e){var t,i,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.data,n.next=3,p.Z.addAppointment(o.token,t.appointment);case 3:return i=n.sent,n.next=6,k(i.patient_id,i.id);case 6:return c=n.sent,n.next=9,m.Z.saveToStorage(v.k0,c);case 9:r(c.passcode);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(n){return console.error("Stream publishMessage() failed",n)})),e.next=18;break;case 17:alert("Something Went Wrong! Please re-enter your information!"),console.log("Null Sync Objects and OnDemand Token Present!"),n.push("/patient/on-demand/info");case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[b,w,g]),(0,o.jsxs)(u.Ar,{children:[(0,o.jsx)(c.b,{title:"Payment Received",icon:(0,o.jsx)("img",{alt:"Payment Success",src:"/icons/payment-success.svg",height:98,width:135}),contentBeforeIcon:!0,content:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("p",{className:"mb-6",children:["We\u2019ve received your payment information, and will be using it to process this visit. ",t&&"Please wait while we process your appointment."]})})}),(0,o.jsx)("div",{className:"my-5 mx-auto max-w-[250px] w-full",children:t?(0,o.jsx)(s.z,{type:"submit",disabled:y,className:"w-full",onClick:P,children:"Connect to Waiting Room"}):(0,o.jsx)(h.Z,{})})]})};_.Layout=d.Z;var C=_}},function(n){n.O(0,[816,221,592,20,283,855,419,199,774,888,179],(function(){return e=84296,n(n.s=e);var e}));var e=n.O();_N_E=e}]);