(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{26281:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/waiting-room",function(){return t(28112)}])},61783:function(e,n,t){"use strict";t.d(n,{N:function(){return c},O:function(){return a}});var r=t(85893),i=t(67294),o=t(34929),c=(0,i.createContext)(null),a=function(e){var n=e.children,t=(0,i.useState)(""),a=t[0],s=t[1],u=(0,i.useState)(null),l=u[0],d=u[1],f=(0,i.useState)(null),m=f[0],h=f[1],v=(0,i.useCallback)((function(e){try{var n=new o.SyncClient(e);window.syncClient=n,s(e),d(n)}catch(t){throw new Error(t)}}),[]);return(0,i.useEffect)((function(){l&&l.stream("OnDemandStream").then((function(e){h(e)}))}),[l]),(0,r.jsx)(c.Provider,{value:{syncToken:a,connect:v,syncClient:l,onDemandStream:m},children:n})}},855:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(67294),i=t(48847),o=t(1438),c=t(83454);function a(){var e,n=(0,r.useState)(o.DF),t=n[0],a=(n[1],{bandwidthProfile:{video:{mode:t.bandwidthProfileMode,dominantSpeakerPriority:t.dominantSpeakerPriority,trackSwitchOffMode:t.trackSwitchOffMode,contentPreferencesMode:t.contentPreferencesMode,clientTrackSwitchOffControl:t.clientTrackSwitchOffControl}},dominantSpeaker:!0,networkQuality:{local:1,remote:1},maxAudioBitrate:Number(t.maxAudioBitrate),preferredVideoCodecs:[{codec:"VP8",simulcast:"peer-to-peer"!==t.roomType&&"go"!==t.roomType}],environment:c.env.REACT_APP_TWILIO_ENVIRONMENT});return i.tq&&(null===a||void 0===a||null===(e=a.bandwidthProfile)||void 0===e?void 0:e.video)&&(a.bandwidthProfile.video.maxSubscriptionBitrate=25e5),"dev"===c.env.REACT_APP_TWILIO_ENVIRONMENT&&(a.wsServer="wss://us2.vss.dev.twilio.com/signaling"),(0,i.po)(a)}},30708:function(e,n,t){"use strict";var r=t(85893);n.Z=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(e){var t=e.children;return n.reduceRight((function(e,n){return(0,r.jsx)(n,{children:e})}),t)}}},69623:function(e,n,t){"use strict";var r=t(85893),i=t(11163),o=t(67294),c=t(51582),a=t(8225),s=t(61783),u=t(50784),l=t(855),d=t(15428),f=(0,t(30708).Z)((function(e){var n=(0,c.R)(),t=n.visit,a=n.user,s=(0,d.Z)(),u=s.getAudioAndVideoTracks,l=s.localTracks,f=s.room,m=(0,o.useState)(),h=m[0],v=m[1];return(0,o.useEffect)((function(){h||f||u().catch((function(e){console.log("Error acquiring local media:"),console.dir(e),v(e),i.default.push("/patient/video/no-av-permission")}))}),[u,h]),t&&a&&l&&l.length>1&&(0,r.jsx)(r.Fragment,{children:e.children})}),a.a,s.O);n.Z=function(e){var n=(0,l.Z)();return(0,r.jsx)(c.KX,{children:(0,r.jsx)(u.Z,{options:n,onError:function(e){console.log("catchErrorAndRedirect",e),i.default.push("/patient/visit-survey/")},children:(0,r.jsx)(f,{children:e.children})})})}},73870:function(e,n,t){"use strict";t.d(n,{c:function(){return m}});var r=t(85893),i=t(67294),o=t(53352),c=t(15428),a=t(97811),s=t(23074),u=t(90961);function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function d(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],c=!0,a=!1;try{for(t=t.call(e);!(c=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);c=!0);}catch(s){a=!0,i=s}finally{try{c||null==t.return||t.return()}finally{if(a)throw i}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return l(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return l(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var n=e.containerClass,t=(0,c.Z)().localTracks,o=t.find((function(e){return"audio"===e.kind})),a=t.find((function(e){return"video"===e.kind})),l=(0,i.useState)(!1),f=l[0],m=l[1],h=(0,i.useState)(!1),v=h[0],p=h[1],x=d((0,u.P)(),2),y=x[0],j=x[1];return(0,i.useEffect)((function(){a&&(v?a.disable():a.enable())}),[v]),(0,i.useEffect)((function(){o&&(f?o.disable():o.enable())}),[f]),(0,r.jsxs)("div",{className:n,children:[j&&(0,r.jsx)(s.z,{className:"my-2",icon:"flip_camera_ios",iconType:"outline",variant:s.W.tertiary,onClick:y}),(0,r.jsx)(s.z,{className:"my-2",icon:v?"videocam_off":"videocam",iconType:"outline",variant:s.W.tertiary,onClick:function(){return p(!v)}}),(0,r.jsx)(s.z,{className:"my-2",icon:f?"mic_off":"mic",iconType:"outline",variant:s.W.tertiary,onClick:function(){return m(!f)}})]})},m=function(e){var n=e.videoImage,t=(0,c.Z)().localTracks,i=t.find((function(e){return"audio"===e.kind})),s=t.find((function(e){return"video"===e.kind}));return(0,r.jsxs)("div",{className:"flex mt-4 mb-1",children:[(0,r.jsx)(f,{containerClass:"flex flex-col justify-center px-1"}),(0,r.jsx)("div",{className:"flex-grow px-1",style:{width:"187px",height:"250px"},children:s?(0,r.jsx)(o.Z,{track:s,isLocal:!0}):(0,r.jsx)("img",{src:n,alt:"Video"})}),i&&(0,r.jsx)(a.Z,{track:i})]})}},28112:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var r=t(85893),i=t(67294),o=t(23074),c=t(39716),a=t(99490),s=function(e){var n=e.name;return(0,r.jsx)(c.J,{className:"mr-2 text-tertiary",name:n})},u=function(e){var n=e.date,t=a.ou.fromISO(n);return(0,r.jsxs)("div",{className:"flex w-3/4 border border-light rounded-lg text-secondary",children:[(0,r.jsxs)("div",{className:"flex p-2 border-r border-light",children:[(0,r.jsx)(s,{name:"calendar_today"})," ",t.toFormat("DD")]}),(0,r.jsxs)("div",{className:"flex p-2",children:[(0,r.jsx)(s,{name:"schedule"})," ",t.toFormat("t")]})]})},l=t(9783),d=t(31199),f=t(39891),m=t(73870),h=t(51582),v=t(15428),p=t(36539),x=t(11163),y=t(69623),j=t(22004),g=t(1107),w=function(){var e=(0,i.useState)(!1),n=e[0],t=e[1],c=(0,h.R)(),a=c.visit,s=c.user,y=(0,v.Z)().getAudioAndVideoTracks,w=(0,i.useState)(),k=w[0],S=w[1],N=(0,i.useState)(),b=N[0],T=N[1],_=(0,x.useRouter)();function A(e,n){p.G.checkRoom(e,n.roomName).then((function(t){t.roomAvailable?_.push("/patient/video/"):A(e,n)}))}return(0,i.useEffect)((function(){k||y().catch((function(e){console.log("Error acquiring local media:"),console.dir(e),S(e)}))}),[y,k]),(0,i.useEffect)((function(){s&&a&&g.Z.fetchContentForPatient(s,a.ehrProvider.id).then((function(e){T(e)}))}),[s,a]),(0,i.useEffect)((function(){s&&a&&A(s,a)}),[_,a,s]),(0,r.jsxs)(d.Ar,{children:[a&&b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.X,{children:"Your Appointment"}),(0,r.jsxs)("div",{className:"mb-2 text-secondary flex flex-col items-center",children:[(0,r.jsx)("p",{children:a.ehrProvider.name}),(0,r.jsx)(u,{date:a.ehrAppointment.start_datetime_ltz.toString()})]}),(0,r.jsxs)("div",{className:"my-4 px-10 md:px-2 lg:px-2 xl:px-2 flex flex-col items-center justify-center",children:[(0,r.jsx)(m.c,{videoImage:"/patient.jpg"}),(0,r.jsx)("div",{className:"text-tertiary",children:"Your visit will start when the provider joins"}),(0,r.jsx)(j.Z,{url:b.video_url,width:320,height:180,controls:!0}),(0,r.jsx)(o.z,{className:"mt-2 px-8",variant:o.W.secondary,outline:!0,onClick:function(){return t(!0)},children:"Leave Waiting Room"})]})]}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(f.u,{isVisible:n,children:(0,r.jsxs)("div",{className:"flex flex-col text-center p-4",children:[(0,r.jsx)("p",{className:"mb-4 text-primary",children:"Are you sure you want to leave the waiting room? Your visit will start shortly."}),(0,r.jsx)(o.z,{className:"mt-2 px-8",onClick:function(){return t(!1)},children:"Stay in Waiting Room"}),(0,r.jsx)(o.z,{onClick:function(){_.push("/patient/waiting-room/left")},className:"mt-2 px-8",variant:o.W.secondary,outline:!0,children:"Leave Waiting Room"})]})})]})};w.Layout=y.Z;var k=w},36539:function(e,n,t){"use strict";t.d(n,{G:function(){return u}});var r=t(34051),i=t.n(r),o=t(43820);function c(e,n,t,r,i,o,c){try{var a=e[o](c),s=a.value}catch(u){return void t(u)}a.done?n(s):Promise.resolve(s).then(r,i)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){c(o,r,i,a,s,"next",e)}function s(e){c(o,r,i,a,s,"throw",e)}a(void 0)}))}}function s(){return(s=a(i().mark((function e(n,t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(o.X.get(o.X.visits.recording),{method:"POST",body:JSON.stringify({room_sid:t,action:r}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var u={checkRoom:function(e,n){return fetch(o.X.get(o.X.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:n}),headers:{authorization:"Bearer ".concat(e.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},createRoom:function(e,n){return fetch(o.X.get(o.X.visits.providerRoomToken),{method:"POST",body:JSON.stringify({room_name:n}),headers:{authorization:"Bearer ".concat(e.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},toggleRecording:function(e,n,t){return s.apply(this,arguments)}}}},function(e){e.O(0,[816,221,809,592,20,283,4,855,419,199,774,888,179],(function(){return n=26281,e(e.s=n);var n}));var n=e.O();_N_E=n}]);